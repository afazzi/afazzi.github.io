{{ define "body" }}
  <body class="{{ if .Site.Params.backgroundImage }}background-image{{ end }}" 
        {{ if .Site.Params.backgroundImage }}style="background-image: url('{{ .Site.Params.backgroundImage }}');"{{ end }}>
{{ end }}

{{ define "main" }}
  {{ $site := . }}  {{/* Capture top-level context */}}
  <main>
    <div>
      {{ with $site.Site.Params.Portrait.Path }}
        <img src="{{ $site.Site.Params.Portrait.Path }}" class="circle" 
             alt="{{ $site.Site.Params.Portrait.Alt }}" 
             style="max-width:{{ $site.Site.Params.Portrait.MaxWidth }}" />
      {{ end }}

      <h1>{{ $site.Site.Title }}</h1>

      {{ partial "subtitle.html" $site }}

      {{ with $site.Site.Params.social }}
        <div>
          {{ partial "social-icons.html" . }}
        </div>
      {{ end }}

      <section class="recent-posts">
        <h2>Recent Posts</h2>
        <ul>
          {{ range first 5 (where $site.Site.RegularPages "Section" "posts") }}
            <li>
              <a href="{{ .RelPermalink }}">{{ .Title }}</a>
              <span class="date">{{ .Date.Format "Jan 2, 2006" }}</span>
            </li>
          {{ end }}
        </ul>
      </section>
    </div>
  </main>
{{ end }}